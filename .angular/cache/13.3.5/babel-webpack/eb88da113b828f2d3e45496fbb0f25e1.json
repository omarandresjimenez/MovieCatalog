{"ast":null,"code":"import { combineLatest } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/movie.catalog.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"./components/searchbar/searchbar.component\";\nimport * as i4 from \"./components/cardMovie/card-movie.component\";\nimport * as i5 from \"./components/modal/modal.component\";\n\nfunction CatalogComponent_section_0_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 6)(1, \"app-card-movie\", 7);\n    i0.ɵɵlistener(\"selectedCard\", function CatalogComponent_section_0_div_4_Template_app_card_movie_selectedCard_1_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return ctx_r4.onSelectCard($event);\n    });\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const movie_r3 = ctx.$implicit;\n    i0.ɵɵstyleProp(\"padding-bottom\", 20, \"px\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"card\", movie_r3);\n  }\n}\n\nfunction CatalogComponent_section_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\", 2)(1, \"div\", 3);\n    i0.ɵɵelement(2, \"app-searchbar\");\n    i0.ɵɵelementStart(3, \"div\", 4);\n    i0.ɵɵtemplate(4, CatalogComponent_section_0_div_4_Template, 2, 3, \"div\", 5);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.moviesCatalog$);\n  }\n}\n\nfunction CatalogComponent_app_modal_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-modal\", 8);\n    i0.ɵɵlistener(\"backCatalog\", function CatalogComponent_app_modal_1_Template_app_modal_backCatalog_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.onBack();\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"card\", ctx_r1.cardInfo)(\"casts\", ctx_r1.casts);\n  }\n}\n\nexport let CatalogComponent = /*#__PURE__*/(() => {\n  class CatalogComponent {\n    constructor(serviceCatalog, cdr) {\n      this.serviceCatalog = serviceCatalog;\n      this.cdr = cdr;\n      this.casts = [];\n      this.cardInfo = null;\n      this.catalogView = true;\n      this.subs = [];\n    }\n\n    set sub(sub) {\n      this.subs.push(sub);\n    }\n\n    ngOnInit() {\n      this.serviceCatalog.searchMovies('');\n      this.sub = combineLatest([this.serviceCatalog.movieCatalog$, this.serviceCatalog.ratingFilter$]).subscribe(([res, filter]) => {\n        this.catalogView = true;\n        this.moviesCatalog$ = [...res.filter(item => item.rating >= filter)];\n        this.cdr.markForCheck();\n      });\n    }\n\n    ngOnDestroy() {\n      this.subs.forEach(sub => sub.unsubscribe());\n    }\n\n    onSelectCard(id) {\n      this.sub = this.serviceCatalog.getCastMovie(id).subscribe(res => {\n        this.casts.length = 0;\n        this.casts = res;\n        this.catalogView = false;\n        this.cardInfo = this.moviesCatalog$.find(card => card.id === id);\n        this.cdr.markForCheck();\n      });\n    }\n\n    onBack() {\n      this.catalogView = true;\n      this.cardInfo = null;\n      this.casts.length = 0;\n    }\n\n  }\n\n  CatalogComponent.ɵfac = function CatalogComponent_Factory(t) {\n    return new (t || CatalogComponent)(i0.ɵɵdirectiveInject(i1.MovieCatalogService), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n  };\n\n  CatalogComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CatalogComponent,\n    selectors: [[\"app-catalog\"]],\n    decls: 2,\n    vars: 2,\n    consts: [[\"class\", \"details-card\", 4, \"ngIf\"], [3, \"card\", \"casts\", \"backCatalog\", 4, \"ngIf\"], [1, \"details-card\"], [1, \"container\"], [1, \"row\"], [\"class\", \"col-md-3\", 3, \"paddingBottom\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-md-3\"], [3, \"card\", \"selectedCard\"], [3, \"card\", \"casts\", \"backCatalog\"]],\n    template: function CatalogComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, CatalogComponent_section_0_Template, 5, 1, \"section\", 0);\n        i0.ɵɵtemplate(1, CatalogComponent_app_modal_1_Template, 1, 2, \"app-modal\", 1);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.catalogView);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.catalogView && ctx.cardInfo);\n      }\n    },\n    directives: [i2.NgIf, i3.SearchbarComponent, i2.NgForOf, i4.CardMovieComponent, i5.ModalComponent],\n    styles: [\"section[_ngcontent-%COMP%]{padding:70px 0}.details-card[_ngcontent-%COMP%]{background:#ecf0f1}\"],\n    changeDetection: 0\n  });\n  return CatalogComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}